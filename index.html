<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
</head>
<body>
    <h1>Calculator</h1>
    <div id="calculator">
        <!-- Calculator UI elements -->
    </div>
    <script>
        // Improved audio context handling
        let audioContext;
        try {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } catch (e) {
            console.error('Web Audio API is not supported in this browser.');
        }

        // Safe DOM manipulation with null checks
        const calculator = document.getElementById('calculator');
        if (!calculator) {
            console.error('Calculator element not found.');
            return;
        }

        // History tracking logic improvements
        const history = [];
        function addToHistory(calculation) {
            if (calculation) {
                history.push(calculation);
            } else {
                console.error('Invalid calculation.');
            }
        }

        // Better error handling for calculations
        function calculate(input) {
            try {
                const result = eval(input); // Replace this with a safer method
                addToHistory(input + '=' + result);
                return result;
            } catch (error) {
                console.error('Error in calculation:', error);
                return 'Error';
            }
        }

        // Safe display updates
        function updateDisplay(result) {
            const displayElement = document.getElementById('display');
            if (displayElement) {
                displayElement.innerText = result;
            } else {
                console.error('Display element not found.');
            }
        }
    </script>
</body>
</html>